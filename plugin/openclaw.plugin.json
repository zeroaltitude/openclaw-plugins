{
  "id": "vestige",
  "name": "Vestige Cognitive Memory",
  "version": "0.1.0",
  "description": "Shared cognitive memory for OpenClaw agents powered by Vestige â€” FSRS-6 spaced repetition, dual-strength memory, and prediction error gating.",
  "author": "BigHat Biosciences",
  "main": "dist/index.js",
  "configSchema": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "serverUrl": {
        "type": "string",
        "description": "Vestige bridge server URL",
        "default": "http://vestige.internal:8000"
      },
      "authToken": {
        "type": "string",
        "description": "Bearer token for Vestige API authentication"
      },
      "taintPolicy": {
        "type": "object",
        "description": "Per-trust-level policy modes: allow (no restrictions), deny (block turn), restrict (apply tool removal policies), confirm (restrict with interactive approval)",
        "properties": {
          "system": { "type": "string", "enum": ["allow", "deny", "restrict", "confirm"], "default": "allow" },
          "owner": { "type": "string", "enum": ["allow", "deny", "restrict", "confirm"], "default": "allow" },
          "local": { "type": "string", "enum": ["allow", "deny", "restrict", "confirm"], "default": "allow" },
          "shared": { "type": "string", "enum": ["allow", "deny", "restrict", "confirm"], "default": "restrict" },
          "external": { "type": "string", "enum": ["allow", "deny", "restrict", "confirm"], "default": "restrict" },
          "untrusted": { "type": "string", "enum": ["allow", "deny", "restrict", "confirm"], "default": "restrict" }
        }
      },
      "policies": {
        "type": "array",
        "description": "Custom security policies. Merged with defaults (no-exec-when-external, no-send-when-untrusted, max-recursion). Each policy has a name, condition (when), and action.",
        "items": {
          "type": "object",
          "properties": {
            "name": { "type": "string", "description": "Policy name for logging" },
            "when": {
              "type": "object",
              "description": "Condition that triggers this policy",
              "properties": {
                "contextTaintIncludes": {
                  "type": "array",
                  "items": { "type": "string", "enum": ["system", "owner", "local", "shared", "external", "untrusted"] },
                  "description": "Policy triggers if context taint includes any of these levels. Ignored when taint policy mode is confirm/restrict."
                },
                "iterationGte": { "type": "number", "description": "Policy triggers if iteration count >= this value" },
                "toolsUsed": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "Policy triggers if all of these tools have been used in the turn"
                }
              }
            },
            "action": {
              "type": "object",
              "description": "What to do when the policy matches",
              "properties": {
                "removeTools": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "Remove these tools from the available set"
                },
                "blockTools": {
                  "type": "array",
                  "items": { "type": "string" },
                  "description": "Block these tools entirely"
                },
                "blockTurn": { "type": "boolean", "description": "Block the entire turn" },
                "reason": { "type": "string", "description": "Human-readable reason for the action" }
              }
            }
          },
          "required": ["name", "when", "action"]
        }
      },
      "approvalTtlSeconds": {
        "type": "number",
        "description": "How long an approval code is valid (default: 60)",
        "default": 60
      }
    }
  },
  "uiHints": {
    "serverUrl": { "label": "Server URL", "placeholder": "https://vestige.bighatbio.me/api" },
    "authToken": { "label": "Auth Token", "sensitive": true }
  }
}
